$:.push File.expand_path("../lib", __FILE__)
require 'biotcm'
require 'bundler/setup'

# test
require 'rake/testtask'
Rake::TestTask.new do |t|
  t.libs << 'test'
  t.test_files = FileList["test/**/test_*.rb"]
  # t.verbose = true
end
task :default => :test

# cop
namespace :cop do
  task :default do
    system('bundle exec rubocop')
  end
  task :files do
    system('bundle exec rubocop --format files')
  end
  task :html do
    system('bundle exec rubocop --format html -o rubocop.html')
    system('firefox rubocop.html')
  end
end
desc 'Run RuboCop to check styles'
task :cop => ['cop:default']

# doc
desc "Open YARD doc server"
task :doc do
  system("bundle exec yard server -r")
end

# clean
desc "Clean the directory"
task :clean do
  FileList[".yardoc", "doc", "*.gem"].each do |d|
    FileUtils.rm_r(d) rescue nil
  end
end

# clear
desc "Clear log files and temporary files in BioTCM.wd"
task :clear do
  ["log", "tmp"].each do |d|
    FileUtils.rm_r(BioTCM.path_to(d)) rescue nil
  end
end

# clear all
desc "Clear all files in BioTCM.wd"
task :clear_all => :clear do
  FileUtils.rm_r(BioTCM.path_to("data")) rescue nil
end

# gem
desc "Build the gem"
task :gem do
  system("gem build #{File.dirname(__FILE__)}" + "/biotcm.gemspec")
end

# install
desc "Install the gem"
task :install => :gem do
  system("gem install biotcm-#{BioTCM::VERSION}.gem --local --no-document")
end

# uninstall
desc "Uninstall the gem"
task :uninstall do
  system("gem uninstall biotcm")
end
